{
  "openapi": "3.0.3",
  "info": {
    "title": "## Documentação Encurtador de links\n",
    "description": "ShortURL",
    "termsOfService": "http://swagger.io/terms/",
    "version": "1.0.0",
    "contact": {
      "name": "Bruno",
      "email": "mello.bruno@live.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3333",
      "description": "Local"
    },
    {
      "url": "",
      "description": "UAT"
    },
    {
      "url": "",
      "description": "Develop"
    },
    {
      "url": "",
      "description": "Production"
    }
  ],
  "tags": [
    {
      "name": "Shortened URL",
      "description": "Encurtador links"
    }
  ],
  "paths": {
    "/shortenedUrl": {
      "post": {
        "tags": [
          "Shortened URL"
        ],
        "summary": "Encurtador de URL",
       "description": "***A API permite encurtar URLs tanto para usuários autenticados quanto não autenticados. Por razões de segurança, apenas URLs com certificado (https://) são permitidas.***",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLink"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateLinkResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{shortId}": {
      "get": {
        "tags": [
          "Shortened URL"
        ],
        "description": "Redireciona para a URL original e adicionar +1 na coluna clicks",
        "parameters": [
          {
            "$ref": "#/components/parameters/ShortIdParameter"
          }
        ],
        "responses": {
          "302": {
            "description": "Redirecionamento para a URL original"
          },
          "404": {
            "description": "URL encurtada não encontrada"
          }
        }
      },
      "patch": {
        "tags": [
          "Shortened URL"
        ],
        "description": "Atualiza url de destino/link original",
        "parameters": [
          {
            "$ref": "#/components/parameters/ShortIdParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateLinkResponse"
                }
              }
            }
          },
          "404": {
            "description": "URL encurtada não encontrada"
          }
        }
      },
      "delete": {
        "tags": [
          "Shortened URL"
        ],
        "description": "Desativa url encurtada",
        "parameters": [
          {
            "$ref": "#/components/parameters/ShortIdParameter"
          }
        ],
        "responses": {
          "204": {
            "description": "OK"
          },
          "404": {
            "description": "URL encurtada não encontrada"
          }
        }
      }
    },
    "/sessions": {
      "post": {
        "tags": [
          "Sessions"
        ],
        "summary": "Autenticação (login)",
        "description": "Rota utilizada para fazer login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Sessions"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rota utilizada para fazer login",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "session": {
                      "$ref": "#/components/schemas/LoginData"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid params."
          },
          "401": {
            "description": "Wrong email or password."
          },
          "500": {
            "description": "Internal server error."
          }
        }
      }
    },
    "/refresh-token": {
      "post": {
        "tags": [
          "Sessions"
        ],
        "summary": "Validar e recriar Refresh Token",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SessionsToken"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rota utilizada para validar a existência de um Refresh Token e renová-lo",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "token": {
                      "$ref": "#/components/schemas/LoginData"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid params."
          },
          "404": {
            "description": "Refresh Token not found."
          },
          "500": {
            "description": "Internal server error."
          }
        }
      }
    },
    "/users": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "users",
        "description": "***Cria um novo usuário***",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Resposta com sucesso"
          },
          "400": {
            "description": "Invalid params."
          },
          "500": {
            "description": "Internal server error."
          }
        }
      }
    },
    "/list": {
      "get": {
        "tags": [
          "Shortened URL"
        ],
        "summary": "Listar URLs",
        "description": "***Lista todas url criada pelo usuário autenticado***",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ShortIdParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LisUrl"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CreateLink": {
        "type": "object",
        "properties": {
          "url": {
            "type": "string",
            "example": "https://teddy360.com.br/material/marco-legal-das-garantias-sancionado-entenda-o-que-muda/"
          }
        }
      },
      "CreateLinkResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": "01"
          },
          "originalUrl": {
            "type": "string",
            "example": "https://www.gamevicio2.com/"
          },
          "shortUrl": {
            "type": "string",
            "example": "http://localhost:3333/DWHL40xo1"
          },
          "shortId": {
            "type": "string",
            "example": "DWHL40xo1"
          },
          "userId": {
            "type": "number",
            "format": "1",
            "example": 1
          },
          "clicks": {
            "type": "number",
            "format": "01",
            "example": 5
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-06-25T23:16:36.223Z"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-06-25T23:16:36.223Z"
          }
        }
      },
      "Sessions": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "example": "contact@johndoe.com"
          },
          "password": {
            "type": "string",
            "example": "123456"
          }
        }
      },
      "SessionsToken": {
        "type": "object",
        "properties": {
          "refreshToken": {
            "type": "string",
            "example": "4512f95b-486a-46bd-ac4b-6f644bf2296f"
          }
        }
      },
      "LoginData": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3MTY1NTM2MzcsImV4cCI6MTcxNjU4MjQzNywic3ViIjoiNjY0ZTAxYzUyZTQwZjg2NWQ4YTY0ZThlIn0.WwTlfIavAAwi0kp78WnD0lypomWxNtzeRXjg1hcn0SQ"
          },
          "user": {
            "type": "object",
            "properties": {
              "email": {
                "type": "string",
                "example": "contact@johndoe.com"
              }
            }
          },
          "refreshToken": {
            "type": "string",
            "example": "3daea6e4-1487-4de3-bc84-7dbf7542412e"
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nome do usuário",
            "example": "john doe"
          },
          "email": {
            "type": "string",
            "example": "johndoe@example.com"
          },
          "password": {
            "type": "string",
            "example": "6654df1e6d20dcb5d7bad2d9"
          }
        }
      },
      "LisUrl": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "number",
              "example": "26"
            },
            "originalUrl": {
              "type": "string",
              "example": "https://teddy360.com.br/material/marco-legal-das-garantias-sancionado-entenda-o-que-muda/"
            },
            "shortUrl": {
              "type": "string",
              "example": "http://localhost:3333/xESOL9"
            },
            "shortId": {
              "type": "string",
              "example": "xESOL9"
            },
            "userId": {
              "type": "number",
              "example": "1"
            },
            "clicks": {
              "type": "number",
              "example": "0"
            },
            "createdAt": {
              "type": "string",
              "format": "date-time",
              "example": "2024-06-27T04:30:14.167Z"
            },
            "updatedAt": {
              "type": "string",
              "format": "date-time",
              "example": "2024-06-27T04:30:14.167Z"
            }
          }
        }
      }
    },
    "parameters": {
      "ShortIdParameter": {
        "name": "shortId",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "example": "sqJsd7frI"
        }
      }
    }
  }
}
